---
id: "KRX-028"
title: "Make revwalk errors visible in normal output"
type: improvement
status: done
priority: high
labels: ["error-handling", "ux"]
created: "2026-01-26"
updated: "2026-01-26"
assignee: null
---

# Make revwalk errors visible in normal output

## Context
When errors occur during commit traversal in `find_root_commit`, the code logs a warning but continues. Users running without `--verbose` will never see this warning, potentially leading to incomplete changelog generation.

## Current Implementation
In `src/git/range.rs:87-96`:

```rust
for oid_result in revwalk {
    match oid_result {
        Ok(oid) => root_oid = oid,
        Err(e) => {
            warn!(
                "Error during revwalk traversal: {}. Continuing with last valid commit.",
                e
            );
        }
    }
}
```

The warning goes to the tracing system but isn't visible without verbose mode.

## Proposed Improvement
Accumulate traversal errors and report a summary to the user after the walk completes.

## Acceptance Criteria
- [x] User sees a warning if revwalk errors occurred
- [x] Warning includes count of errors and suggests `--verbose` for details
- [x] Individual error details remain at DEBUG level
- [x] Normal operation (no errors) produces no extra output

## Technical Notes
**File:** `src/git/range.rs:87-96`

Suggested fix:
```rust
let mut traversal_errors = Vec::new();
for oid_result in revwalk {
    match oid_result {
        Ok(oid) => root_oid = oid,
        Err(e) => {
            tracing::debug!("Revwalk error: {}", e);
            traversal_errors.push(e);
        }
    }
}
if !traversal_errors.is_empty() {
    tracing::warn!(
        "Encountered {} errors during commit traversal. Results may be incomplete. \
         Run with --verbose for details.",
        traversal_errors.len()
    );
}
```

---

## Resolution

**Completed:** 2026-01-26

### Approach
Implemented the suggested fix exactly as proposed in the issue. Individual errors are now logged at DEBUG level and a summary warning with error count is displayed at WARN level when errors occur.

### Changes Made
- `src/git/range.rs`:
  - Changed import from `use tracing::warn` to `use tracing::{debug, warn}`
  - Added `traversal_errors` vector to accumulate errors during revwalk
  - Changed individual error logging from `warn!` to `debug!`
  - Added summary warning after loop completes if any errors occurred

### Testing
- [x] Build passes (`cargo build`)
- [x] Type checks pass (`cargo check`)
- [x] All 146 tests pass (`cargo test`)

---
*Solved by Claude Code*
