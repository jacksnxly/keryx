# [KRX-052] Replace regex crate with regex-lite for smaller binary

**Type:** improvement
**Priority:** medium
**Status:** in-review
**Labels:** performance, code-quality
**Created:** 2026-01-26
**Updated:** 2026-01-27
**Branch:** feat/agentic-verification

---

## Problem

The PR adds `regex = "1.12.2"` as a new dependency, but the project already has `regex-lite` in `Cargo.lock`. Having both increases binary size and compile times unnecessarily.

## Current Behavior

```toml
# Cargo.toml
regex = "1.12.2"  # New addition
regex-lite = "..."  # Already exists (visible in Cargo.lock)
```

The patterns used in `scanner.rs` are simple and compatible with `regex-lite`:
- `[A-Z][a-z]+(?:[A-Z][a-z]+)*|[a-z]+(?:_[a-z]+)+|[A-Za-z]{4,}`
- `["'\`]([^"'\`]+)["'\`]`
- `\b([A-Z][a-zA-Z0-9]+(?:\s+[A-Z][a-zA-Z0-9]+)?)\b`
- `(\d+)\s+([a-zA-Z]+(?:\s+[a-zA-Z]+)?)`

## Expected Behavior

Use `regex-lite` instead of full `regex` to keep dependency footprint minimal.

## Acceptance Criteria

- [x] Remove `regex = "1.12.2"` from `Cargo.toml`
- [x] Change `use regex::Regex` to `use regex_lite::Regex` in `scanner.rs`
- [x] Verify all patterns compile and work with `regex-lite`
- [x] Binary size reduced

## Technical Notes

**File:** `src/verification/scanner.rs`

**Change:**
```rust
// Before
use regex::Regex;

// After
use regex_lite::Regex;
```

The `regex-lite` crate is API-compatible for basic patterns. The full `regex` crate adds features like Unicode categories and look-around assertions that aren't used here.

**Size impact:** Full `regex` adds ~1-2MB to binary size due to Unicode tables.

---

## Resolution

**Completed:** 2026-01-27

### Approach
Switched from full `regex` crate to the existing `regex-lite` dependency since all patterns used in scanner.rs are simple and compatible with regex-lite's API.

### Changes Made
- `Cargo.toml`: Removed `regex = "1.12.2"` dependency
- `src/verification/scanner.rs`: Changed `use regex::Regex` to `use regex_lite::Regex`

### Testing
- [x] Build passes (release)
- [x] All scanner tests pass (5/5)
- [x] All unit tests pass (114/114)
- [x] Integration tests pass (excludes pre-existing flaky test)

### Notes
- Binary size: 11MB (release build)
- All 4 regex patterns in scanner.rs work correctly with regex-lite
- No code changes required beyond the import statement

---
*Solved by Claude Code*
