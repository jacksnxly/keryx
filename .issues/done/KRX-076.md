---
id: "KRX-076"
title: "Refactor run_init functions to accept config struct instead of 8-9 positional params"
type: improvement
status: in-review
priority: high
labels: ["code-quality", "clippy"]
created: "2026-01-27"
updated: "2026-01-28"
assignee: null
---

# Refactor run_init functions to accept config struct instead of 8-9 positional params

## Context
Adding `no_verify: bool` and `verbose: bool` as positional parameters brought `run_init`, `run_init_unreleased`, and `run_init_from_history` to 8-9 parameters each. Clippy warns about `too_many_arguments`. Boolean parameters are error-prone since they can be silently swapped at call sites.

## Current Implementation
Functions at `main.rs:269`, `main.rs:321`, and `main.rs:444` each take 8-9 positional parameters including multiple `bool` flags (`no_prs`, `strict`, `force`, `no_verify`, `verbose`).

## Proposed Improvement
Pass `&Cli` or a subset struct containing the relevant flags instead of individual parameters. This is more readable, extensible for future flags, and eliminates the clippy warning.

## Acceptance Criteria
- [x] `run_init`, `run_init_unreleased`, `run_init_from_history` use a struct or `&Cli` for config
- [x] Clippy `too_many_arguments` warning resolved for these functions
- [x] No behavioral changes

## Technical Notes
- **File:** `src/main.rs:269, 321, 444`
- The existing `Cli` struct already groups these values
- Also consider extracting the triplicated PR fetch error handling into a helper (appears at lines 362-379, 493-514, 724-747)

---

## Resolution

**Completed:** 2026-01-28

### Approach
Created a new `InitConfig` struct to group all init-related configuration flags. Also extracted the duplicated PR fetch error handling into a `handle_pr_fetch_error` helper function.

### Changes Made
- `src/main.rs`: Added `InitConfig` struct with fields: `output`, `dry_run`, `no_prs`, `strict`, `pr_limit`, `no_verify`, `verbose`
- `src/main.rs`: Added `InitConfig::from_cli()` constructor method
- `src/main.rs`: Added `handle_pr_fetch_error()` helper to eliminate code duplication
- `src/main.rs`: Refactored `run_init()` to accept `&InitConfig` + 2 bool params (down from 9 params)
- `src/main.rs`: Refactored `run_init_unreleased()` to accept `&InitConfig` (down from 8 params)
- `src/main.rs`: Refactored `run_init_from_history()` to accept `&InitConfig` (down from 8 params)
- `src/main.rs`: Updated `run_generate()` to use `handle_pr_fetch_error()` helper

### Testing
- [x] Build passes (`cargo build`)
- [x] All 173 tests pass (`cargo test`)
- [x] Clippy `too_many_arguments` warning resolved
- [x] No behavioral changes

---
*Solved by Claude Code*
