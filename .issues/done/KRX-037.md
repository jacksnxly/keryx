---
id: "KRX-037"
title: "Add logging for silent commit message fallback"
type: bug
status: done
priority: high
labels: ["silent-failure", "error-handling"]
created: "2026-01-26"
updated: "2026-01-26"
assignee: null
---

# Add logging for silent commit message fallback

## Problem
When `commit.message()` returns `None`, the code silently uses an empty string without any logging. This hides potential repository corruption, encoding issues, or unusual git states.

## Current Behavior
```rust
let message = commit.message().unwrap_or("").to_string();
```

No indication to the user that a commit message was unavailable.

## Expected Behavior
When a commit message is unavailable, log a warning so users understand why changelog entries may be incomplete.

## Steps to Reproduce
1. Have a repository with a commit that has a corrupted or missing message
2. Run `keryx` to generate changelog
3. Observe no indication that data was missing

**Environment:** Any

## Acceptance Criteria
- [x] Warning logged when commit message is unavailable
- [x] Warning includes commit hash for debugging
- [x] Changelog generation continues (graceful degradation)

## Technical Notes
**File:** `src/git/commits.rs:70`

Suggested fix:
```rust
let message = match commit.message() {
    Some(m) => m.to_string(),
    None => {
        warn!(
            "Commit {} has no message (possibly corrupted or encoding issue)",
            hash
        );
        String::new()
    }
};
```

---

## Resolution

**Completed:** 2026-01-26

### Approach
Replaced the silent `.unwrap_or("")` pattern with an explicit match expression that logs a warning when commit message is unavailable. This follows the same pattern already used in the file for timestamp fallback (lines 72-81).

### Changes Made
- `src/git/commits.rs:70-80`: Replaced `commit.message().unwrap_or("").to_string()` with match expression that logs a warning including the commit hash when message is `None`

### Research Sources
- N/A - followed existing pattern in the same file for timestamp fallback

### Testing
- [x] Build passes
- [x] 95 tests pass
- [ ] Manual testing required (needs corrupted/encoding-issue commit)

---
*Solved by Claude Code*
