---
id: "KRX-007"
title: "Implement FromStr trait for CommitType instead of from_str method"
type: improvement
status: in-review
priority: low
labels: [code-quality, api]
created: "2026-01-25"
updated: "2026-01-25"
started: "2026-01-25"
assignee: null
---

# Implement FromStr trait for CommitType instead of from_str method

## Context
The `CommitType::from_str` method shadows the standard library's `std::str::FromStr::from_str` trait method signature, which can be confusing.

## Current Implementation
In `src/git/commits.rs:27`:
```rust
impl CommitType {
    pub fn from_str(s: &str) -> Option<Self> {
        // ...
    }
}
```
Returns `Option<Self>` instead of `Result<Self, Error>` like the standard trait.

## Proposed Improvement
Either:
1. Implement the `FromStr` trait properly (returns `Result`)
2. Rename to `parse(s: &str)` or `try_from_str(s: &str)`

## Acceptance Criteria
- [x] Method name no longer shadows `FromStr::from_str`
- [x] API is idiomatic Rust
- [x] All call sites updated
- [x] Clippy warning resolved

## Technical Notes
**File:** `src/git/commits.rs:27`

Option 1 - Implement FromStr:
```rust
impl std::str::FromStr for CommitType {
    type Err = (); // or a custom error type

    fn from_str(s: &str) -> Result<Self, Self::Err> {
        // ... return Ok(variant) or Err(())
    }
}
```

Option 2 - Rename method:
```rust
pub fn parse(s: &str) -> Option<Self> { ... }
```

---

## Resolution

**Completed:** 2026-01-25

### Approach
Implemented the `std::str::FromStr` trait for `CommitType` following the existing pattern established by `ChangelogCategory` in the codebase. Used `type Err = String` for meaningful error messages and updated the call site to use idiomatic `.parse().ok()`.

### Changes Made
- `src/git/commits.rs:25-43`: Replaced inherent `impl CommitType` block with `impl std::str::FromStr for CommitType`
  - Changed return type from `Option<Self>` to `Result<Self, Self::Err>`
  - Changed `Some(...)` to `Ok(...)` and `None` to `Err(format!("Unknown commit type: {}", s))`
- `src/git/commits.rs:99`: Updated call site from `CommitType::from_str(type_str)` to `type_str.parse::<CommitType>().ok()`

### Research Sources
- [FromStr in std::str - Rust Official Docs](https://doc.rust-lang.org/std/str/trait.FromStr.html)
- Existing codebase pattern: `ChangelogCategory` in `src/changelog/format.rs:42-56`

### Testing
- [x] Build passes (`cargo build`)
- [x] Type checks pass (`cargo check`)
- [x] All 91 tests pass (`cargo test`)
- [x] Clippy linting passes (`cargo clippy`)

---
*Solved by Claude Code*
